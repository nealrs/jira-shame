services:
  jira-shame:
    build: .
    ports:
      # Use 1337 locally to match dev; set PORT=3000 (or 80) when deploying behind a proxy
      - "${PORT:-1337}:3000"
    environment:
      - JIRA_HOST=${JIRA_HOST}
      - JIRA_EMAIL=${JIRA_EMAIL}
      - JIRA_API_TOKEN=${JIRA_API_TOKEN}
      - JIRA_BOARD_ID=${JIRA_BOARD_ID}
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - GITHUB_ORG=${GITHUB_ORG}
      - NODE_ENV=production
      - DEBUG=${DEBUG:-false}
      - PORT=3000
      - TZ=${TZ:-America/New_York}
    restart: unless-stopped
    # Remove volume mounts for production - code is baked into image
    # Add health check if /health endpoint is implemented
    # healthcheck:
    #   test: ["CMD", "node", "-e", "require('http').get('http://localhost:3000/health', (r) => {process.exit(r.statusCode === 200 ? 0 : 1)})"]
    #   interval: 30s
    #   timeout: 10s
    #   retries: 3
    #   start_period: 40s
